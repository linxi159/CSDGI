import numpy as npimport pandas as pdimport timeimport random# [1] data load #df1 = pd.read_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_nontumor198tumor317_deg.csv', index_col=0) # dimension = (genes x cells)df2 = pd.read_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_tumor317_deg.csv', index_col=0) # dimension = (genes x cells)#df1 = df.iloc[0:3,:]c1 = pd.read_csv('./result_2_label/left_0_n2_label.csv',header=None) # dimension = (genes x cells)  mal1257c2 = pd.read_csv('./result_2_label/left_1_n2_label.csv',header=None) # dimension = (genes x cells)  ben3388c1.index = list(df1.index[1:])c2.index = list(df1.index[1:])c1.columns = ["importance"]c2.columns = ["importance"]cc1 = pd.read_csv('./result_2_without_label/left_0_n2_without_label.csv',header=None) # dimension = (genes x cells)cc2 = pd.read_csv('./result_2_without_label/left_1_n2_without_label.csv',header=None) # dimension = (genes x cells)cc1.index = list(df2.index[0:])cc2.index = list(df2.index[0:])cc1.columns = ["importance"]cc2.columns = ["importance"]n2_label = pd.read_csv('./result_2_without_label/labels_predict_n2_without_label.csv', header=None) # dimension = (genes x cells)n2_label.columns = ["label"]n2_label.index = list(df2.columns)# [2] data processing #print("starting ...")c1_=c1.sort_values(["importance"],ascending=False)c2_=c2.sort_values(["importance"],ascending=False)# top 20 genes for comparisonsubtype1_label_tumor_gene = c1_.index[0:20]subtype2_label_nontumor_gene = c2_.index[0:20]cc1_=cc1.sort_values(["importance"],ascending=False)cc2_=cc2.sort_values(["importance"],ascending=False)# the number of CSDGs is 0.05*820=41, top 5%subtype1_without_label_gene = cc1_.index[0:41]subtype2_without_label_gene = cc2_.index[0:41]# [3] save processing results ## nontumor - tumordf1_nontumor = df1.iloc[:,0:198] # nontumornontumor_top20_gene = list(subtype2_label_nontumor_gene)nontumor_top20_gene.append('group')df1_nontumor_ = df1_nontumor.loc[nontumor_top20_gene,:]df1_tumor = df1.iloc[:,198:] # maltumor_top20_gene = list(subtype1_label_tumor_gene)tumor_top20_gene.append('group')df1_tumor_ = df1_tumor.loc[tumor_top20_gene,:]df1_tumor_ = df1_tumor_.Tdf1_nontumor_ = df1_nontumor_.T df1_tumor_.to_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_nontumor198tumor317_deg_tumortop20.csv')df1_nontumor_.to_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_nontumor198tumor317_deg_nontumortop20.csv')# tumorn2_label_ = n2_label.Tdf2_= n2_label_.append(df2)n1 = df2_.shape[0] # row  genesn2 = df2_.shape[1] # col  cellscell_names_1 = []cell_names_2 = [] for i in range(n2):     if (df2_.iloc[0,i] == 1):        cell_names_1.append(df2_.columns[i])     elif(df2_.iloc[0,i] == 2):        cell_names_2.append(df2_.columns[i])         subtype1 = list(subtype1_without_label_gene)subtype1.append('group')subtype2 = list(subtype2_without_label_gene)subtype2.append('group')df2_index=list(df2.index)df2_index.insert(0,'group')df2_.index = df2_indexdf2_subtype1 = df2_.loc[subtype1,cell_names_1]df2_subtype2 = df2_.loc[subtype2,cell_names_2]df2_subtype1 = df2_subtype1.Tdf2_subtype2 = df2_subtype2.Tdf2_subtype1.to_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_nontumor198tumor317_deg_tumor_subtype1_top_5%.csv')df2_subtype2.to_csv('./data/GSE75688_GEO_processed_Breast_Cancer_raw_TPM_matrix_gene_filtering_log_nontumor198tumor317_deg_tumor_subtype2_top_5%.csv')