import numpy as npimport pandas as pdimport timeimport random# [1] data load #df1 = pd.read_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_ben3388mal1257_deg.csv', index_col=0) # dimension = (genes x cells)df2 = pd.read_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_mal1257_deg.csv', index_col=0) # dimension = (genes x cells)#df1 = df.iloc[0:3,:]c1 = pd.read_csv('./result_2_label/left_0_n2_label.csv',header=None) # dimension = (genes x cells)  mal1257c2 = pd.read_csv('./result_2_label/left_1_n2_label.csv',header=None) # dimension = (genes x cells)  ben3388c1.index = list(df1.index[1:])c2.index = list(df1.index[1:])c1.columns = ["importance"]c2.columns = ["importance"]cc1 = pd.read_csv('./result_3_without_label/left_0_n3_without_label.csv',header=None) # dimension = (genes x cells)cc2 = pd.read_csv('./result_3_without_label/left_1_n3_without_label.csv',header=None) # dimension = (genes x cells)cc3 = pd.read_csv('./result_3_without_label/left_2_n3_without_label.csv',header=None) # dimension = (genes x cells)cc1.index = list(df2.index[0:])cc2.index = list(df2.index[0:])cc3.index = list(df2.index[0:])cc1.columns = ["importance"]cc2.columns = ["importance"]cc3.columns = ["importance"]n3_label = pd.read_csv('./result_3_without_label/labels_predict_n3_without_label.csv', header=None) # dimension = (genes x cells)n3_label.columns = ["label"]n3_label.index = list(df2.columns)# [2] data processing #print("starting ...")c1_=c1.sort_values(["importance"],ascending=False)c2_=c2.sort_values(["importance"],ascending=False)# top 20 genes for comparisonsubtype1_label_mal_gene = c1_.index[0:20]subtype2_label_ben_gene = c2_.index[0:20]cc1_=cc1.sort_values(["importance"],ascending=False)cc2_=cc2.sort_values(["importance"],ascending=False)cc3_=cc3.sort_values(["importance"],ascending=False)# the number of CSDGs is 0.05*1170=59, top 5%subtype1_without_label_gene = cc1_.index[0:59]subtype2_without_label_gene = cc2_.index[0:59]subtype3_without_label_gene = cc3_.index[0:59]# [3] save processing results ## bendf1_ben = df1.iloc[:,0:3388] # benben_top14_gene = list(subtype2_label_ben_gene)ben_top14_gene.append('group')df1_ben_ = df1_ben.loc[ben_top14_gene,:]df1_mal = df1.iloc[:,3388:] # malmal_top14_gene = list(subtype1_label_mal_gene)mal_top14_gene.append('group')df1_mal_ = df1_mal.loc[mal_top14_gene,:]df1_mal_ = df1_mal_.Tdf1_ben_ = df1_ben_.T df1_mal_.to_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_ben3388mal1257_deg_maltop20.csv')df1_ben_.to_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_ben3388mal1257_deg_bentop20.csv')# maln3_label_ = n3_label.Tdf2_= n3_label_.append(df2)n1 = df2_.shape[0] # row  genesn2 = df2_.shape[1] # col  cellscell_names_1 = []cell_names_2 = [] cell_names_3 = []  for i in range(n2):     if (df2_.iloc[0,i] == 1):        cell_names_1.append(df2_.columns[i])     elif(df2_.iloc[0,i] == 2):        cell_names_2.append(df2_.columns[i])     else:        cell_names_3.append(df2_.columns[i])         subtype1 = list(subtype1_without_label_gene)subtype1.append('group')subtype2 = list(subtype2_without_label_gene)subtype2.append('group')subtype3 = list(subtype3_without_label_gene)subtype3.append('group')df2_index=list(df2.index)df2_index.insert(0,'group')df2_.index = df2_indexdf2_subtype1 = df2_.loc[subtype1,cell_names_1]df2_subtype2 = df2_.loc[subtype2,cell_names_2]df2_subtype3 = df2_.loc[subtype3,cell_names_3]df2_subtype1 = df2_subtype1.Tdf2_subtype2 = df2_subtype2.Tdf2_subtype3 = df2_subtype3.Tdf2_subtype1.to_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_mal1257_deg_mal_subtype1_top_5%.csv')df2_subtype2.to_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_mal1257_deg_mal_subtype2_top_5%.csv')df2_subtype3.to_csv('./data/GSE72056_melanoma_single_cell_revised_v2_gene_filtering_mal1257_deg_mal_subtype3_top_5%.csv')