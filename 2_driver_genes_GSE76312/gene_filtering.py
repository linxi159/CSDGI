import numpy as npimport pandas as pdimport timeimport random# [1] data preprocessing #df = pd.read_csv('./data/GSE76312_Single_cell_HSCs_expression_RPKM_table.csv', index_col=0) # dimension = (genes x cells)#df1 = df.iloc[0:3,:]print("starting preprocessing:")n1 = df.shape[0] # row  genesn2 = df.shape[1] # col  cellsgene_names = []r=0.06for i in range(n1):    if (i >= 0):        cnt = 0        tmp = df.iloc[i,:]        for j in range(n2):            if tmp[j] != 0:                cnt += 1        if cnt < r*n2 or cnt >= (1-r)*n2:            #print(cnt)            gene_names.append(df.index[i])#print("gene_names", gene_names)df1=df.drop(index=gene_names)X0 =  df1.values.copy()X0_log = df1.values.copy()X0_log = np.log(X0_log+1) # 取对数df2 = pd.DataFrame(X0_log, index=df1.index, columns=df1.columns) df2.to_csv('./data/GSE76312_Single_cell_HSCs_expression_RPKM_table_gene_filtering_log.csv')